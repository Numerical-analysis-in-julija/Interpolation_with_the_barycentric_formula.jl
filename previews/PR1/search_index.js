var documenterSearchIndex = {"docs":
[{"location":"#Interpolation-with-the-barycentric-formula","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"","category":"section"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"This is the documentation for the repository of homework 3 Interpolation with the barycentric formula of the course Numerical Methods. This documentation is devided in two parts: the first one is the documentation of the mathematical backround of the task and the second part is the documentation of the code we used to solve the task.","category":"page"},{"location":"#Mathematical-backround","page":"Interpolation with the barycentric formula","title":"Mathematical backround","text":"","category":"section"},{"location":"#Introduction","page":"Interpolation with the barycentric formula","title":"Introduction","text":"","category":"section"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"The point of the given task is to numerically interpolate the following function: e^(-x^2)  on ([-1,1]) , sin(x)/x  on ([0,10]) and |x^2-2x|  on ([1,3]). The interpolation is done with the barycentric formula and Chebyshev points. ","category":"page"},{"location":"#Chebyshev-points","page":"Interpolation with the barycentric formula","title":"Chebyshev points","text":"","category":"section"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"Chebyshev points are the roots of the Chebyshev polynomials. The Chebyshev polynomials are defined as a sequence of orthogonal polynomials defined on the interval [−1,1].","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"Chebyshev points of the first kind in the interval [−1,1] are given by the formula:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<table align=\"center\">     <tr>         <td>             <img src=https://latex.codecogs.com/svg.latex?x_k%20%3D%20%5Ccos%5Cleft%28%5Cfrac%7B%282k&plus;1%29%5Cpi%7D%7B2%28n&plus;1%29%7D%5Cright%29>         </td>     </tr> </table>","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"And for the Chebyshev points on the interval [a, b]:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<table align=\"center\">     <tr>         <td>             <img src=https://latex.codecogs.com/svg.latex?x_k%20%3D%20%5Cfrac%7Ba&plus;b%7D%7B2%7D%20&plus;%20%5Cfrac%7Bb-a%7D%7B2%7D%20%5Ccos%5Cleft%28%5Cfrac%7B%282k&plus;1%29%5Cpi%7D%7B2%28n&plus;1%29%7D%5Cright%29>         </td>     </tr> </table>","category":"page"},{"location":"#Barycentric-formula","page":"Interpolation with the barycentric formula","title":"Barycentric formula","text":"","category":"section"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"The barycentric formula is a method for numerical interpolation. It is based on the Lagrange interpolation formula. The Lagrange interpolation formula is the following:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<table align=\"center\">     <tr>         <td>             <img src=https://latex.codecogs.com/svg.latex?p(x)%20=%20\\sum{j=0}^{n}%20f(xj)%20\\ell_j(x)>         </td>     </tr> </table>","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"But this formula is numerically unstable, so we use the barycentric formula instead. The barycentric formula is the following:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<table align=\"center\">     <tr>         <td>             <img src=https://latex.codecogs.com/svg.latex?p(x)%20=%20\\frac{\\sum{j=0}^{n}%20\\lambdaj%20f(xj)%20/%20(x%20-%20xj)}{\\sum{j=0}^{n}%20\\lambdaj%20/%20(x%20-%20x_j)}>         </td>     </tr> </table>","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"This formula offers a numerically stable way to interpolate a function and it is also faster than the Lagrange interpolation formula.","category":"page"},{"location":"#The-results-of-the-interpolation","page":"Interpolation with the barycentric formula","title":"The results of the interpolation","text":"","category":"section"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"The following pictures show the results of the interpolation of the given functions with the barycentric formula and Chebyshev points.","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"e^(-x^2)","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<p align=\"center\">   <img width=\"460\" height=\"300\" src=\"./images/ezgif-4-cfcfa1457c.gif\"> </p>","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"sin(x)/x ","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<p align=\"center\">   <img width=\"460\" height=\"300\" src=\"./images/ezgif-4-e9a28c1c2b.gif\"> </p>","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"|x^2-2x|","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"<p align=\"center\">   <img width=\"460\" height=\"300\" src=\"./images/ezgif-4-53e4254853.gif\"> </p>","category":"page"},{"location":"#Code-documentation","page":"Interpolation with the barycentric formula","title":"Code documentation","text":"","category":"section"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"First we calculate the Chebyshev nodes using the second formula for the Chebyshev points. We use the following function to calculate the Chebyshev nodes:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"function chebyshev_nodes(n, a, b)\n\n    # Check the nodes calculation\n    nodes = [cos(π * (i / n)) for i in 0:n]\n    \n    # Check the mapping to the interval\n    mapped_nodes = [(a + b) / 2 + (b - a) / 2 * x for x in nodes]\n   \n    return mapped_nodes\nend","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"Next we calculate the weights for the barycentric formula. We use the following function to calculate the weights:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"function chebyshev_weights(n)\n    weights = [Float64((-1)^i) for i in 0:n]\n    weights[1] *= 0.5\n    weights[end] *= 0.5\n    return weights\nend","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"After that we can caculate the barycentric interpolation using the barycentric formula. We use the following function to calculate the barycentric interpolation:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"function barycentric_interpolation(nodes,values, weights, x)\n   if x in nodes\n        return values[nodes .== x][1]\n    else\n         # Calculate the numerator\n         numerator = sum(values[i] * weights[i] ./ (x .- nodes[i]) for i in 1:length(nodes))\n         # Calculate the denominator\n         denominator = sum(weights[i] ./ (x .- nodes[i]) for i in 1:length(nodes))\n    end\n\n    return numerator / denominator\nend","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"After we have the barycentric interpolation we can run the code so that we are in the exaptible level of precision. We use the following function to run the code:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"function get_optimal_degree(func, a, b,n,precision)\n    while true\n        nodes = chebyshev_nodes(n, a, b)\n        values = [func(node) for node in nodes]\n        weights = chebyshev_weights(n)\n        \n        test_points = range(a, stop=b, length=1000)\n        max_error = 0.0\n\n        for x in test_points\n            interpolated_value = barycentric_interpolation(nodes, values, weights, x)\n            error = abs(func(x) - interpolated_value)\n            max_error = max(max_error, error)\n        end\n\n        if max_error < precision\n            return n\n        end\n\n        n += 1  \n    \n    end\nend","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"Finally we can plot the results of the interpolation. We use the following function to plot the results:","category":"page"},{"location":"","page":"Interpolation with the barycentric formula","title":"Interpolation with the barycentric formula","text":"function plot_interpolation(f, a, b, n, name)\n    nodes = chebyshev_nodes(n, a, b)\n    values = [f(node) for node in nodes]\n    weights = chebyshev_weights(n)\n    \n    x_vals = range(a, stop=b, length=1000)\n    y_true = [f(x) for x in x_vals]\n    y_interp = [barycentric_interpolation(nodes, values, weights, x) for x in x_vals]\n    \n    p = plot(x_vals, y_true, label=\"Original $name\", lw=2)\n    plot!(p, x_vals, y_interp, label=\"Interpolated $name n=$n\", linestyle=:dash, lw=2)\n    title!(\"Interpolation of $name with degree $n\")\n    xlabel!(\"x\")\n    ylabel!(\"f(x)\")\n    return p\nend","category":"page"}]
}
